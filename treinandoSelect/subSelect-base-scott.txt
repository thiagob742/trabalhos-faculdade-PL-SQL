SELECT E.ENAME, E.EMPNO, E.SAL, E.JOB
FROM EMP E INNER JOIN (SELECT MAX(SAL)MAIOR, JOB FROM EMP
GROUP BY JOB) M ON E.SAL =  M.MAIOR
WHERE E.JOB = M.JOB;

SELECT * FROM EMP
WHERE (SAL, JOB) IN (SELECT MAX(SAL)MAIOR, JOB FROM EMP
GROUP BY JOB);


SELECT E.ENAME, E.EMPNO, E.SAL, E.JOB
FROM EMP E INNER JOIN (SELECT  MIN(SAL)MENOR, JOB FROM EMP
GROUP BY JOB) M ON E.SAL =  M.MENOR
WHERE E.JOB = M.JOB
ORDER BY SAL;


SELECT E.ENAME, E.DEPTNO, E.JOB, E.HIREDATE FROM EMP E INNER JOIN (SELECT MAX(HIREDATE) DATA, DEPTNO  FROM EMP
GROUP BY DEPTNO) M ON E.HIREDATE = M.DATA;


SELECT * FROM EMP 
WHERE HIREDATE IN (SELECT MAX(HIREDATE) DATA FROM EMP
                          GROUP BY DEPTNO);


SELECT E.ENAME, E.SAL, E.DEPTNO FROM EMP E INNER JOIN (SELECT ROUND(AVG(SAL),2) MEDIA, DEPTNO FROM EMP
GROUP BY DEPTNO) D ON E.DEPTNO = D.DEPTNO
WHERE E.SAL > D.MEDIA;


SELECT * FROM DEPT 
WHERE DEPTNO NOT IN (SELECT DEPTNO FROM EMP 
GROUP BY DEPTNO);


SELECT COUNT(EMPNO) MAIOR, EXTRACT(YEAR FROM HIREDATE) FROM EMP
GROUP BY  EXTRACT(YEAR FROM HIREDATE)  HAVING COUNT(EMPNO) = (SELECT MAX(COUNT(EMPNO)) NUMERO_EMPREGADOS FROM EMP
GROUP BY EXTRACT(YEAR FROM HIREDATE));

SELECT E.ENAME, E.SAL, E.DEPTNO, D.MEDIA FROM EMP E INNER JOIN (SELECT ROUND(AVG(SAL),2) MEDIA, DEPTNO FROM EMP
GROUP BY DEPTNO) D ON E.DEPTNO = D.DEPTNO
WHERE E.SAL > D.MEDIA;

SELECT E.* FROM EMP E
INNER JOIN (SELECT SAL FROM EMP ORDER BY SAL DESC) D
ON E.SAL = D.SAL
WHERE ROWNUM <= 3;



SELECT D.DEPTNO COD_DEP, D.DNAME NOME_DEP, COUNT(E.EMPNO) QUANT_FUNCIO
      FROM DEPT D 
        LEFT OUTER JOIN EMP E 
            ON D.DEPTNO = E.DEPTNO
                GROUP BY D.DEPTNO, D.DNAME;
                
                
  SELECT D.DEPTNO COD_DEP, D.DNAME NOME_DEP, COUNT(E.EMPNO) QUANT_FUNCIO
      FROM DEPT D 
       LEFT OUTER JOIN EMP E 
            ON D.DEPTNO = E.DEPTNO
                GROUP BY D.DEPTNO, D.DNAME;


SELECT D.DEPTNO COD_DEP, E.ENAME NOME_FUNC
      FROM DEPT D LEFT OUTER JOIN EMP E 
            ON  D.DEPTNO = E.DEPTNO
              ORDER BY D.DEPTNO;
              
              
              
SELECT D.DEPTNO COD_DEP, D.DNAME NOME_DEP, COUNT(E.EMPNO) QUANT_FUNCIO
      FROM DEPT D, 
        EMP E 
         WHERE  D.DEPTNO  = E.DEPTNO (+)
                GROUP BY D.DEPTNO, D.DNAME;
                
                
SELECT E.ENAME, E.SAL, G.GRADE, G.LOSAL, G.HISAL
FROM EMP E INNER JOIN SALGRADE G
ON (E.SAL BETWEEN G.LOSAL AND G.HISAL);



